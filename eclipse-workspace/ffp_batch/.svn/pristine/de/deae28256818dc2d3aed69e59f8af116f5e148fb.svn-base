SET SCHEMA RTCXU01;
DROP VIEW  V_D_OPR_DC_D ;
DROP VIEW  V_MSG_SEND_CENTER ;
DROP VIEW  V_HASTEN_SEND_MSG ;
DROP VIEW  V_MSG_OVERSEAS_RECV ;
DROP VIEW  V_MSG_RECV ;
DROP VIEW  V_MSG_RECV_APV ;
DROP VIEW  V_O_PROVINCE_REPORT ;
DROP VIEW  V_OI_PROVINCE_REPORT ;
DROP VIEW  V_MSG_SEND_NET ;
DROP VIEW  USER_CHRG_VIEW ;
DROP VIEW  V_CREDIBT_REPORT ;
DROP VIEW  V_REVERT_TEMPLET ;
DROP VIEW  V_MSG_OVERSEAS_RECV_HANG ;
DROP VIEW  V_MSG_RECV_HANG ;
DROP VIEW  V_HOMEPAGE_NEW ;
DROP VIEW  V_I_PROVINCE_REPORT ;
DROP VIEW  V_MSG_OVERSEAS_SEND ;
DROP VIEW  GROUPM_MESSAGE_INFO ;
DROP VIEW  V_D_OPR_DC_C ;
DROP VIEW  HANGLIST ;
DROP VIEW  V_DC_QUARTER_REPORT ;
----------------------------
CREATE VIEW "RTCXU01"."GROUPM_MESSAGE_INFO" AS  select B.* from (( Select 
qry_no, sysibm.min(oref_qry_no) as oref_qry_no from RTCXU01.M_MESSAGE_INFO 
where msg_state = '26' and is_pigeonhole = 'N' and hastencount < 3 and 
is_send_accept = '2' group by qry_no) A left join RTCXU01.M_MESSAGE_INFO 
B on A.oref_qry_no = B.oref_qry_no );
CREATE VIEW "RTCXU01"."HANGLIST" AS  select '1' AS ROWID, '合计' AS OREF_NO,CHAR(count(1))||'笔' 
as MSG_TYPE,'' as SND_DATE,'' as VAL_DATE, CCY, SUM(TRADE_AMT) as TRADE_AMT,''as 
HANG_DATE, '' as CDT_REASON, '' as CUBKNO,'' as SND_BKNO,IO_FLAG, MSG_STATUS, 
CURR_DATE from RTCXU01. R_HANG_ACT GROUP BY CCY, CURR_DATE,MSG_STATUS,IO_FLAG 
UNION ALL SELECT '0' AS ROWID, OREF_NO, MSG_TYPE, SND_DATE, VAL_DATE, CCY, 
TRADE_AMT, HANG_DATE, CDT_REASON, CUBKNO, SND_BKNO, IO_FLAG, MSG_STATUS, 
CURR_DATE FROM RTCXU01. R_HANG_ACT;
CREATE VIEW "RTCXU01"."V_CREDIBT_REPORT" AS  SELECT '1' AS ROWID, '' AS 
OREF_NO,'' as MSG_TYPE,'' as ORG_SEND_DATE,'' as VAL_DATE, TRADE_CCY, SUM(TRADE_AMT) 
as TRADE_AMT,''as ORG_RECV_DATE, '' as SEND_BKNO,'' as MEMO,CURREN_DATE 
from RTCXU01.CREDIBT_REPORT GROUP BY TRADE_CCY, CURREN_DATE UNION ALL SELECT 
'0' AS ROWID, OREF_NO, MSG_TYPE, ORG_SEND_DATE, VAL_DATE, TRADE_CCY, TRADE_AMT, 
ORG_RECV_DATE, SEND_BKNO, MEMO, CURREN_DATE from RTCXU01.CREDIBT_REPORT;
CREATE VIEW "RTCXU01"."V_DC_QUARTER_REPORT" AS  select A.DCOUNT + B.DCOUNT 
as DCOUNT, A.DAMT + B.DAMT as DAMT, A.CCOUNT + B. CCOUNT as CCOUNT, A.CAMT 
+ A.CAMT AS CAMT, A.DCOUNT + B.DCOUNT + A.CCOUNT + B.CCOUNT as ALLCOUNT, 
A.DAMT + B.DAMT + A.CAMT + A.CAMT AS ALLAMT FROM ( SELECT SUM( CASE MSGID 
WHEN 'B231' THEN 1 ELSE 0 END) as DCOUNT , SUM( CASE MSGID WHEN 'B231' 
THEN RAMT ELSE 0 END ) as DAMT, SUM( CASE MSGID WHEN 'B245' THEN 1 ELSE 
0 END) as CCOUNT , SUM( CASE MSGID WHEN 'B245' THEN RAMT ELSE 0 END ) as 
CAMT FROM RTCXU01.RTCFBMTP WHERE RCCY = '001' and SEND_DAT between '20060701' 
and '20060901' AND MSGID = 'B231' OR MSGID = 'B245' ) A , ( SELECT SUM( 
CASE CMT_CODE WHEN 'B231' THEN 1 ELSE 0 END) as DCOUNT , SUM( CASE CMT_CODE 
WHEN 'B231' THEN OAMT ELSE 0 END ) as DAMT, SUM( CASE CMT_CODE WHEN 'B245' 
THEN 1 ELSE 0 END) as CCOUNT , SUM( CASE CMT_CODE WHEN 'B245' THEN OAMT 
ELSE 0 END ) as CAMT FROM RTCXU01.RTCFBMTC WHERE CURSYMB = '001' and SND_DATE 
between '20060701' and '20060901' AND CMT_CODE = 'B231' OR CMT_CODE = 'B245' 
) B;
CREATE VIEW "RTCXU01"."V_D_OPR_DC_C" AS  SELECT A.OREF_NO,TRANS_DATE FROM 
RTCXU01.D_OPR_DC A JOIN ( select OREF_NO, MAXNO FROM ( SELECT C.OREF_NO, 
MAX(SEQ_NO) AS MAXNO,MaxSEQ_NO FROM RTCXU01. D_OPR_DC C JOIN ( select OREF_NO,Max(SEQ_NO)as 
MaxSEQ_NO from RTCXU01. D_OPR_DC where ACT_NO LIKE '9051%' and DC_FLAG='C' 
and STRIKE_FLAG is null group by OREF_NO) B ON C.OREF_NO=B.OREF_NO GROUP 
BY C.OREF_NO, MaxSEQ_NO ) B where MAXNO = MaxSEQ_NO ) B ON A.OREF_NO = 
B.OREF_NO and SEQ_NO = MAXNO;
CREATE VIEW "RTCXU01"."V_D_OPR_DC_D" AS  select A."OREF_NO","TRANS_DATE" 
from "RTCXU01"."D_OPR_DC" A, ( select "OREF_NO","DC_FLAG",Max("TRANS_DATE")as 
Maxdate from "RTCXU01"."D_OPR_DC" where "DC_FLAG"='D' and left("ACT_NO",4)='9052' 
and STRIKE_FLAG is null group by "OREF_NO","DC_FLAG")B where A."OREF_NO"=B.OREF_NO 
and A.DC_FLAG=B. DC_FLAG and left("ACT_NO",4)='9052';
CREATE VIEW "RTCXU01"."V_I_PROVINCE_REPORT" AS  select B.CN_PROVINCE, COUNT(1) 
as ICOUNT,SUM(RVAMT) as RVAMT from RTCXU01. RTCFBMTD A JOIN RTCXU01.COM_NO_PROVINCE 
B ON LEFT(SDBKNO,3) = NUMBER WHERE RVCCY = '001' AND (MSGTYPE = 'B245' 
OR MSGTYPE = 'B249') GROUP BY B. CN_PROVINCE;
CREATE VIEW "RTCXU01"."V_OI_PROVINCE_REPORT" AS  SELECT COALESCE(A.CN_PROVINCE,B.CN_PROVINCE) 
AS CN_PROVINCE, VALUE(A.ICOUNT,0) + VALUE(B.ICOUNT,0) as ICOUNT, VALUE(A.OAMT,0) 
+ VALUE(B.RAMT,0) AS OAMT FROM ( select B.CN_PROVINCE, COUNT(1) as ICOUNT,SUM(OAMT) 
as OAMT from RTCXU01.RTCFBMTC A JOIN RTCXU01.COM_NO_PROVINCE B ON LEFT(RDFI_CODE,3) 
= NUMBER where (CMT_CODE LIKE 'I%') AND CURSYMB = '001' GROUP BY B.CN_PROVINCE 
) A LEFT JOIN ( select B.CN_PROVINCE, COUNT(1) as ICOUNT,SUM(RAMT) as RAMT 
from RTCXU01.RTCFBMTP A JOIN RTCXU01.COM_NO_PROVINCE B ON LEFT(ODFI_CODE,3) 
= NUMBER where (MSGID LIKE 'I%') AND RCCY = '001' GROUP BY B.CN_PROVINCE 
) B ON B.CN_PROVINCE = A.CN_PROVINCE;
CREATE VIEW "RTCXU01"."V_O_PROVINCE_REPORT" AS  SELECT COALESCE(A.CN_PROVINCE,B.CN_PROVINCE) 
AS CN_PROVINCE, VALUE(A.ICOUNT,0) + VALUE(B.ICOUNT,0) as ICOUNT, VALUE(A.OAMT,0) 
+ VALUE(B.RAMT,0) AS OAMT FROM ( select B.CN_PROVINCE, COUNT(1) as ICOUNT,SUM(OAMT) 
as OAMT from RTCXU01.RTCFBMTC A JOIN RTCXU01.COM_NO_PROVINCE B ON LEFT(RDFI_CODE,3) 
= NUMBER where (CMT_CODE = 'B245' OR CMT_CODE = 'B249') AND CURSYMB = '001' 
GROUP BY B.CN_PROVINCE ) A LEFT JOIN ( select B.CN_PROVINCE, COUNT(1) as 
ICOUNT,SUM(RAMT) as RAMT from RTCXU01.RTCFBMTP A JOIN RTCXU01. COM_NO_PROVINCE 
B ON LEFT(ODFI_CODE,3) = NUMBER where (MSGID = 'B245' OR MSGID = 'B249') 
AND RCCY = '001' GROUP BY B.CN_PROVINCE ) B ON B.CN_PROVINCE = A.CN_PROVINCE;
CREATE VIEW "RTCXU01"."V_REVERT_TEMPLET" AS  SELECT A.TEMPLET_CODE, TEMPLET_NAME, 
INS_MGR, INS_DATE FROM RTCXU01. B_REVERT_TEMPLET A JOIN ( SELECT TEMPLET_CODE, 
MIN(FIELD_CODE) as FIELD_CODE from RTCXU01.B_REVERT_TEMPLET GROUP BY TEMPLET_CODE 
) B ON A.TEMPLET_CODE = B.TEMPLET_CODE and A.FIELD_CODE = B.FIELD_CODE;
CREATE VIEW RTCXU01.USER_CHRG_VIEW AS SELECT A.USER_ID, B.USER_NAME, B.CARD_ID, 
CASE A.DEAL_TYPE WHEN '01' THEN '增加' WHEN '02' THEN '删除' WHEN '03' 
THEN '修改' WHEN '04' THEN '激活' WHEN '05' THEN '解锁' WHEN '06' THEN 
'密码重置' END AS DEAL_TYPE, C.USER_GROUP, C.NET_NO, C.RULE_NO, START_DATE, 
END_DATE, CASE C.USER_TYPE WHEN '0' THEN '普通' WHEN '1' THEN '高级' END 
AS USER_TYPE, TXTLER, CHK_TXTLER, CHAR(CHK_TXDATE,ISO) AS STAT_DATE FROM 
RTCXU01.B_PARA_APV AS A JOIN RTCXU01.BASE_USER AS B ON A.USER_ID = B.USER_ID 
JOIN RTCXU01.B_INQUIRY_USER AS C ON A.USER_ID = C.USER_ID WHERE PARA_NAME 
= 'user' AND DEAL_STATUS = '2';
CREATE VIEW "RTCXU01"."V_HASTEN_SEND_MSG" AS SELECT OREF_NO,REV_BKNO,STR_DATE,REV_BKNM,CCY,TRADE_AMT,QRY_DATE,SEND_MSGNO, 
RLT_OREF_NO,TXTLER1,HASTEN_TOTAL_CNT,HASTEN_CNT,MATCH_SEND_MSGNO, MATCH_FIN_MSGNO 
FROM M_OVERSEAS_SEND WHERE HASTEN_FLAG = '0' AND PIGEONHOLE_FLAG ='0' AND 
RTN_CODE = '0000' AND RTN_STATE_CODE = 'ACK' AND HASTEN_DAY > 0 AND NEXT_HASTEN_DATE 
IS NOT NULL AND RTRIM(NEXT_HASTEN_DATE ) <> '' AND NEXT_HASTEN_DATE <= 
CURRENT DATE;
CREATE VIEW "RTCXU01"."V_MSG_SEND_CENTER" AS ( select OREF_NO, MATCH_FIN_MSGNO, 
QRY_DATE, CCY, TRADE_AMT, REV_BKNO, TRAN_NETNO, MSG_TYPE, MSG_STATE, SUMMARY_NO, 
TXTLER1, TXTLER2, TXTLER3, TXTLER4, MSG_FORMAT from RTCXU01.M_OVERSEAS_SEND 
UNION select OREF_QRY_NO as OREF_NO , QRY_NO as MATCH_FIN_MSGNO, QRY_DATE, 
CUCD_NO as CCY, MONEY_AMT as TRADE_AMT, REV_BANK_NO as REV_BKNO, TRADENETNO 
as TRAN_NETNO, QRY_TYPE as MSG_TYPE, MSG_STATE, SUMMARY as SUMMARY_NO, 
TXTLER1, TXTLER2, TXTLER3, TXTLER4, IS_FREE as MSG_FORMAT from RTCXU01.M_MESSAGE_INFO 
where IS_SEND_ACCEPT = '2' and MSG_STATE in ('22', '23', '245') );
CREATE VIEW "RTCXU01"."V_MSG_OVERSEAS_RECV_HANG" AS select OREF_NO, SND_BANK_ID, 
RLT_OREF_NO, MSG_DATE, MSG_TYPE, '' as CURR_CODE, 0.00 as TRADE_AMT, REV_BKNO, 
SND_BKNO, FIN_MSG_NO as MATCH_FIN_MSGNO, DEAL_FLAG , '' as REVERT_FLAG, 
CURR_NETNO as CURR_NET, '' as MSG_STATE, WITHIN_DEAL_FLAG,'1' AS WITHIN_FLAG 
from RTCXU01.M_OVERSEAS_RECV where WITHIN_DEAL_FLAG = '04' AND DEAL_STATUS 
= '2' UNION select OREF_NO, '' as SND_BANK_ID, '' as RLT_OREF_NO, cast(QRY_DATE 
as char( 10 )) as MSG_DATE, MSG_TYPE, CURR_CODE, TRADE_AMT, ( CASE REVERT_FLAG 
WHEN '0' THEN REV_BKNO ELSE SND_BKNO END) as REV_BKNO, ( CASE REVERT_FLAG 
WHEN '0' THEN SND_BKNO ELSE REV_BKNO END) as SND_BKNO, MATCH_FIN_MSGNO, 
DEAL_FLAG , REVERT_FLAG, CURR_NET, MSG_STATE,'' WITHIN_DEAL_FLAG,'2' AS 
WITHIN_FLAG from RTCXU01. M_OVERSEAS_WITHIN where REVERT_FLAG = '4' AND 
MSG_STATE = '1';
CREATE VIEW "RTCXU01"."V_MSG_OVERSEAS_SEND" AS select OREF_NO, MATCH_FIN_MSGNO, 
SEND_MSGNO,QRY_DATE,CCY,TRADE_AMT,REV_BKNO, CURR_NETNO AS SND_BKNO, TXTLER1,MSG_FORMAT,CURR_NETNO, 
MSG_TYPE,MSG_STATE, SUMMARY_NO ,txtler2, txtler3, '1' AS WITHIN_FLAG from 
RTCXU01.M_OVERSEAS_SEND union select OREF_NO,MATCH_FIN_MSGNO, ORG_SM_BKNO 
as SEND_MSGNO,QRY_DATE,CURR_CODE AS CCY,TRADE_AMT,REV_BKNO,SND_BKNO , TXTLER1,MSG_FORMAT,CURR_NET 
AS CURR_NETNO, MSG_TYPE, MSG_STATE , SUMMARY_NO, txtler1 AS txtler2,txtler2 
AS txtler3,'2' AS WITHIN_FLAG from RTCXU01.M_OVERSEAS_WITHIN;

COMMENT ON TABLE "RTCXU01 "."V_MSG_OVERSEAS_SEND" IS '其中包括境外发报表和内部报文发报数据';
CREATE VIEW "RTCXU01"."V_MSG_RECV_APV" AS select OREF_NO, SND_BANK_ID, RLT_OREF_NO, 
MSG_DATE, MSG_TYPE, REV_BKNO, SND_BKNO, FIN_MSG_NO as MATCH_FIN_MSGNO, 
DEAL_FLAG , CURR_NETNO as CURR_NET, '' as MSG_STATE, WITHIN_DEAL_FLAG, 
MATCH_FLAG,DEAL_STATUS, CASE RTRIM(CURR_NETNO) WHEN '94000' THEN TXTLER 
ELSE NETTLER END AS TXTLER, '1' AS WITHIN_FLAG from RTCXU01.M_OVERSEAS_RECV 
where DEAL_STATUS IN ('1','3') AND WITHIN_DEAL_FLAG !='00' UNION SELECT 
OREF_NO,'' AS SND_BANK_ID,'' AS RLT_OREF_NO, QRY_DATE AS MSG_DATE, MSG_TYPE, 
REV_BKNO ,SND_BKNO, MATCH_FIN_MSGNO,DEAL_FLAG,CURR_NET AS CURR_NET,MSG_STATE, 
REVERT_FLAG AS WITHIN_DEAL_FLAG, '' AS MATCH_FLAG,'' AS DEAL_STATUS, TXTLER1 
AS TXTLER ,'2' AS WITHIN_FLAG FROM RTCXU01.M_OVERSEAS_WITHIN WHERE MSG_STATE 
IN ('11','12','15','16');
CREATE VIEW "RTCXU01"."V_MSG_RECV_HANG" AS select OREF_NO, SND_BANK_ID, 
RLT_OREF_NO, MSG_DATE, MSG_TYPE, CURR_CODE, TRADE_AMT, REV_BKNO, SND_BKNO, 
MATCH_FIN_MSGNO, DEAL_FLAG, REVERT_FLAG, CURR_NET, MSG_STATE, WITHIN_DEAL_FLAG,WITHIN_FLAG 
from RTCXU01.V_MSG_OVERSEAS_RECV_HANG;
CREATE VIEW "RTCXU01"."V_MSG_SEND_NET" AS ( select OREF_NO, MATCH_FIN_MSGNO, 
QRY_DATE, CCY, TRADE_AMT, REV_BKNO, SND_BKNO, MSG_TYPE, MSG_STATE, SUMMARY_NO, 
TXTLER1, TXTLER2, TXTLER3, '' as TXDATE2, '' as TXTIME2, '' as TXDATE3, 
'' as TXTIME3, MSG_FORMAT, '0' as IS_BILL, CURR_NETNO,WITHIN_FLAG from 
RTCXU01.V_MSG_OVERSEAS_SEND UNION select OREF_QRY_NO as OREF_NO, QRY_NO 
as MATCH_FIN_MSGNO, QRY_DATE, CUCD_NO as CCY, MONEY_AMT as TRADE_AMT, REV_BANK_NO 
as REV_BKNO, CURRENTNETNO AS SND_BKNO ,QRY_TYPE as MSG_TYPE, MSG_STATE, 
SUMMARY as SUMMARY_NO, TXTLER1 , TXTLER2, TXTLER3, TXDATE2, TXTIME2, TXDATE3, 
TXTIME3, IS_FREE as MSG_FORMAT, IS_BILL, CURRENTNETNO as CURR_NETNO,'' 
AS WITHIN_FLAG from RTCXU01.M_MESSAGE_INFO where IS_SEND_ACCEPT = '2' and 
MSG_STATE in ('21', '225') );
CREATE VIEW RTCXU01.V_MSG_OVERSEAS_RECV AS select OREF_NO, SND_BANK_ID, 
RLT_OREF_NO, MSG_DATE, MSG_TYPE, '' as CURR_CODE, 0 as TRADE_AMT, REV_BKNO, 
SND_BKNO, FIN_MSG_NO as MATCH_FIN_MSGNO, DEAL_FLAG , '' as REVERT_FLAG, 
CURR_NETNO as CURR_NET, '' as MSG_STATE, WITHIN_DEAL_FLAG, MATCH_FLAG,DEAL_STATUS,'1' 
AS MSGFLAG, IN_OUT_FLAG from RTCXU01.M_OVERSEAS_RECV where WITHIN_DEAL_FLAG 
IN ('00','01','08','10','11') AND DEAL_STATUS in ('0','2') UNION select 
OREF_NO, '' as SND_BANK_ID, '' as RLT_OREF_NO, cast(QRY_DATE as char( 10 
)) as MSG_DATE, MSG_TYPE, CURR_CODE, TRADE_AMT, ( CASE REVERT_FLAG WHEN 
'0' THEN REV_BKNO ELSE SND_BKNO END) as REV_BKNO, ( CASE REVERT_FLAG WHEN 
'0' THEN SND_BKNO ELSE REV_BKNO END) as SND_BKNO, MATCH_FIN_MSGNO, DEAL_FLAG 
, REVERT_FLAG, CURR_NET, MSG_STATE,'' WITHIN_DEAL_FLAG, '1' AS MATCH_FLAG,MSG_STATE 
AS DEAL_STATUS, '2' AS MSGFLAG, IN_OUT_FLAG AS IN_OUT_FLAG from RTCXU01. 
M_OVERSEAS_WITHIN where MSG_STATE IN ('99') AND DEAL_FLAG = '0' AND REVERT_FLAG 
= '0';

COMMENT ON TABLE "RTCXU01 "."V_MSG_OVERSEAS_RECV" IS '其中包括境外来报表和内部报文来报数据';
CREATE VIEW RTCXU01.V_MSG_RECV AS select OREF_QRY_NO AS OREF_NO, '' AS SND_BANK_ID, 
'' AS RLT_OREF_NO, QRY_DATE AS MSG_DATE, QRY_TYPE AS MSG_TYPE,CUCD_NO AS 
CURR_CODE, MONEY_AMT AS TRADE_AMT, '' AS REV_BKNO, ( CASE WHEN QRY_TYPE 
= 'C302' AND QRY_BANK_NO = '000000000000' THEN QRY_BANK_NO ELSE SEND_BANK_NO 
END) AS SND_BKNO, QRY_NO AS MATCH_FIN_MSGNO, '' AS DEAL_FLAG, '' AS REVERT_FLAG, 
NETNO AS CURR_NET, MSG_STATE, '' AS WITHIN_DEAL_FLAG, ( CASE WHEN IS_MATCHED 
= 'Y' THEN '1' ELSE '0' END ) AS MATCH_FLAG ,'0' AS ORDER_FLAG,'0' AS DEAL_STATUS,'3' 
AS MSGFLAG, '0' AS IN_OUT_FLAG from RTCXU01. M_MESSAGE_INFO where IS_SEND_ACCEPT 
= '1' and MSG_STATE in ('11', '12') union select OREF_NO, SND_BANK_ID, 
RLT_OREF_NO, MSG_DATE, MSG_TYPE, CURR_CODE, TRADE_AMT, REV_BKNO , SND_BKNO,MATCH_FIN_MSGNO, 
DEAL_FLAG, REVERT_FLAG, CURR_NET, MSG_STATE, WITHIN_DEAL_FLAG, MATCH_FLAG, 
( CASE MSG_TYPE WHEN '192' THEN '1' WHEN '292' THEN '2' ELSE '3' END) AS 
ORDER_FLAG,DEAL_STATUS,MSGFLAG, IN_OUT_FLAG from RTCXU01. V_MSG_OVERSEAS_RECV;
CREATE VIEW "RTCXU01"."V_HOMEPAGE_NEW" AS SELECT NETNO,TXTLER,FUNC FROM 
( SELECT Distinct CURR_NETNO AS NETNO,TXTLER1 AS TXTLER,'checkList' AS 
FUNC FROM RTCXU01.V_MSG_SEND_NET WHERE MSG_STATE IN ( '21' ,'11' ) UNION 
SELECT Distinct TRAN_NETNO AS NETNO,TXTLER3 AS TXTLER, 'amendList' AS FUNC 
FROM RTCXU01.V_MSG_SEND_CENTER WHERE MSG_STATE IN ('245' ,'16' ) UNION 
SELECT Distinct TRAN_NETNO AS NETNO,TXTLER3 AS TXTLER, 'acknowledgeList' 
AS FUNC FROM RTCXU01.V_MSG_SEND_CENTER WHERE MSG_STATE IN ('23' ,'15' ) 
UNION SELECT Distinct '9010165' AS NETNO,'' AS TXTLER, 'authoriseList' 
AS FUNC FROM RTCXU01.V_MSG_SEND_CENTER WHERE MSG_STATE IN ( '22' ,'13' 
) UNION SELECT Distinct CURR_NET AS NETNO,'' AS TXTLER,'revList' AS FUNC 
FROM RTCXU01.V_MSG_RECV WHERE CURR_NET = '9010165' OR ( CURR_NET <> '9010165' 
AND MSG_STATE <> '11') UNION SELECT Distinct CURR_NET AS NETNO,'' AS TXTLER,'hangList' 
AS FUNC FROM RTCXU01.V_MSG_RECV_HANG UNION SELECT Distinct CURR_NETNO AS 
NETNO, TXTLER1 AS TXTLER,'modifyList' AS FUNC FROM RTCXU01.V_MSG_SEND_NET 
WHERE MSG_STATE IN ('225' ,'12' ,'14' ) ) A;
